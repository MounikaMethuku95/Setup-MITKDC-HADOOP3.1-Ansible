# MIT Kerberos LDAP Schema
# This schema defines the LDAP object classes and attributes
# required for storing Kerberos principal data in LDAP.

attributetype ( 1.3.6.1.4.1.5322.17.1.1
    NAME 'krbPrincipalName'
    DESC 'Kerberos principal name'
    EQUALITY caseExactMatch
    SUBSTR caseExactSubstringsMatch
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.15{256}
    SINGLE-VALUE )

attributetype ( 1.3.6.1.4.1.5322.17.1.2
    NAME 'krbPrincipalKey'
    DESC 'Kerberos principal key'
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.40 )

attributetype ( 1.3.6.1.4.1.5322.17.1.3
    NAME 'krbUPEnabled'
    DESC 'Kerberos principal user password enable flag'
    EQUALITY booleanMatch
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.7
    SINGLE-VALUE )

attributetype ( 1.3.6.1.4.1.5322.17.1.4
    NAME 'krbTicketPolicyReference'
    DESC 'DN reference to ticket policy object'
    EQUALITY distinguishedNameMatch
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.12 )

attributetype ( 1.3.6.1.4.1.5322.17.1.5
    NAME 'krbPrincipalType'
    DESC 'Kerberos principal type'
    EQUALITY integerMatch
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
    SINGLE-VALUE )

attributetype ( 1.3.6.1.4.1.5322.17.1.6
    NAME 'krbPwdPolicyReference'
    DESC 'DN reference to password policy object'
    EQUALITY distinguishedNameMatch
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.12 )

attributetype ( 1.3.6.1.4.1.5322.17.1.7
    NAME 'krbUPPrincipalFlags'
    DESC 'Kerberos principal flags'
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.27 )

objectclass ( 1.3.6.1.4.1.5322.17.2.1
    NAME 'krbPrincipal'
    DESC 'Kerberos principal object'
    SUP top
    STRUCTURAL
    MUST ( krbPrincipalName )
    MAY ( krbPrincipalKey $ krbUPEnabled $ krbTicketPolicyReference $
          krbPrincipalType $ krbPwdPolicyReference $ krbUPPrincipalFlags ) )
